<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dropdown</title>
    <style>
      body {
        font-family: system-ui, sans-serif;
        padding: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .wrap {
        position: relative;
        width: fit-content;
      }
      button {
        padding: 10px 12px;
        border: 1px solid #d1d5db;
        border-radius: 10px;
        background: #fff;
        cursor: pointer;
      }
      :focus-visible {
        outline: 3px solid #2563eb;
        outline-offset: 2px;
      }

      .menu {
        position: absolute;
        top: calc(100% + 8px);
        right: 0;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        background: #fff;
        min-width: 220px;
        padding: 8px;
        display: none;
      }

      .menu.is-open {
        display: block;
      }

      .menu button {
        width: 100%;
        text-align: left;
        border: 0;
        padding: 10px;
        border-radius: 10px;
      }

      .menu button:hover {
        background: #f3f4f6;
      }
    </style>
  </head>
  <body>
    <h1>Dropdown</h1>

    <div class="wrap">
      <button id="menuBtn" type="button" aria-haspopup="menu" aria-expanded="false">Actions</button>

      <div id="menu" class="menu" role="menu" aria-label="Actions menu">
        <button type="button" role="menuitem" data-action="edit">Edit</button>
        <button type="button" role="menuitem" data-action="duplicate">Duplicate</button>
        <button type="button" role="menuitem" data-action="delete">Delete</button>
      </div>
    </div>

    <p id="result" role="status" aria-live="polite"></p>

    <script>
      const menuBtn = document.querySelector("#menuBtn");
      const menu = document.querySelector("#menu");
      const result = document.querySelector("#result");

      function openMenu() {
        menu.classList.add("is-open");
        menuBtn.setAttribute("aria-expanded", "true");
      }

      function closeMenu() {
        menu.classList.remove("is-open");
        menuBtn.setAttribute("aria-expanded", "false");
      }

      function isOpen() {
        return menu.classList.contains("is-open");
      }

      menuBtn.addEventListener("click", () => {
        if (isOpen()) closeMenu();
        else openMenu();
      });

      // Click outside closes
      document.addEventListener("click", (event) => {
        const clickedInside = event.target === menuBtn || menu.contains(event.target);
        if (!clickedInside) closeMenu();
      });

      // Escape closes
      document.addEventListener("keydown", (event) => {
        if (event.key !== "Escape") return;
        if (!isOpen()) return;
        closeMenu();
        menuBtn.focus();
      });

      // Handle menu item clicks
      menu.addEventListener("click", (event) => {
        const item = event.target.closest("[data-action]");
        if (!item) return;

        const action = item.dataset.action;
        result.textContent = `You chose: ${action}`;
        closeMenu();
        menuBtn.focus();
      });
    </script>
  </body>
</html>
